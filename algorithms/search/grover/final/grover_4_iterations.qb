// algorithms/search/grover_4_iterations.qb
// 4íšŒ ë°˜ë³µ Grover ì•Œê³ ë¦¬ì¦˜ (99.9% ëª©í‘œ)

fn main() {
    println("ğŸ¯ 4íšŒ ë°˜ë³µ Grover ì•Œê³ ë¦¬ì¦˜");
    println("==========================");
    println("ëª©í‘œ: |10101âŸ© ìƒíƒœ ì°¾ê¸°");
    println("ë°˜ë³µ: 4íšŒ (ì´ë¡ ì  ìµœì )");
    println("");
    
    circuit GroverOptimal(5) {
        println("ğŸš€ ì´ˆê¸°í™”: ê· ë“± ì¤‘ì²© ìƒíƒœ");
        apply H to ~;
        
        println("ğŸ”„ Grover ë°˜ë³µ 1/4");
        // Oracle: |10101âŸ© ë§ˆí‚¹
        apply X to q1;
        apply X to q3;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to q1;
        apply X to q3;
        // Diffusion
        apply H to ~;
        apply X to ~;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to ~;
        apply H to ~;
        
        println("ğŸ”„ Grover ë°˜ë³µ 2/4");
        // Oracle
        apply X to q1;
        apply X to q3;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to q1;
        apply X to q3;
        // Diffusion
        apply H to ~;
        apply X to ~;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to ~;
        apply H to ~;
        
        println("ğŸ”„ Grover ë°˜ë³µ 3/4");
        // Oracle
        apply X to q1;
        apply X to q3;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to q1;
        apply X to q3;
        // Diffusion
        apply H to ~;
        apply X to ~;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to ~;
        apply H to ~;
        
        println("ğŸ”„ Grover ë°˜ë³µ 4/4");
        // Oracle
        apply X to q1;
        apply X to q3;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to q1;
        apply X to q3;
        // Diffusion
        apply H to ~;
        apply X to ~;
        apply CZ to (q0, q1, q2, q3, q4);
        apply X to ~;
        apply H to ~;
    }
    
    println("íšŒë¡œ ì‹¤í–‰ ì¤‘...");
    grover = GroverOptimal();
    
    println("ì¸¡ì • ì¤‘...");
    result = measure(grover, [0, 1, 2, 3, 4]);
    
    println("ê²°ê³¼: {}", result);
    
    // ì‹­ì§„ìˆ˜ ë³€í™˜
    decimal = result[0] + result[1]*2 + result[2]*4 + result[3]*8 + result[4]*16;
    println("ì‹­ì§„ìˆ˜: {}", decimal);
    
    // ì´ì§„ ë¬¸ìì—´ í‘œì‹œ
    binary_str = "|{}{}{}{}{}âŸ©";
    println("ìƒíƒœ: {}", binary_str);
    
    if (decimal == 21) {
        println("âœ… ì„±ê³µ! |10101âŸ© ë°œê²¬!");
        println("ğŸ‰ Grover ì•Œê³ ë¦¬ì¦˜ ì„±ê³µ!");
    } else {
        println("âŒ ì‹¤íŒ¨: ë‹¤ë¥¸ ìƒíƒœ ì¸¡ì •ë¨");
    }
}