// algorithms/search/complete_grover_with_functions.qb
// ì™„ì „í•œ í•¨ìˆ˜ ê¸°ë°˜ Grover ì•Œê³ ë¦¬ì¦˜

fn oracle_10101() {
    println("    ğŸ¯ Oracle: |10101âŸ© ë§ˆí‚¹");
    apply X to q1;
    apply X to q3;
    apply CZ to (q0, q1, q2, q3, q4);
    apply X to q1;
    apply X to q3;
}

fn diffusion_operator() {
    println("    ğŸ”„ Diffusion: ì§„í­ ì¦í­");
    apply H to ~;
    apply X to ~;
    apply CZ to (q0, q1, q2, q3, q4);
    apply X to ~;
    apply H to ~;
}

fn grover_iteration(iteration_num) {
    println("  --- Grover ë°˜ë³µ {}/4 ---", iteration_num);
    oracle_10101();
    diffusion_operator();
}

circuit GroverComplete(5) {
    println("ğŸš€ 5íë¹— Grover ì•Œê³ ë¦¬ì¦˜ ì‹œì‘");
    
    // 1ë‹¨ê³„: ì´ˆê¸°í™”
    println("ğŸ“¦ ì´ˆê¸°í™”: ê· ë“± ì¤‘ì²© ìƒíƒœ");
    apply H to ~;
    
    // 2ë‹¨ê³„: Grover ë°˜ë³µ 4íšŒ
    println("ğŸ”„ Grover ë°˜ë³µ ì‹œì‘");
    
    iterations = range(1, 5);
    for i in iterations {
        grover_iteration(i);
    }
    
    println("âœ… Grover ì•Œê³ ë¦¬ì¦˜ ì™„ë£Œ");
}

fn analyze_result(result) {
    decimal = result[0] + result[1]*2 + result[2]*4 + result[3]*8 + result[4]*16;
    
    if (decimal == 21) {
        println("âœ… ì„±ê³µ! |10101âŸ© ë°œê²¬!");
        return true;
    } else {
        println("âŒ ë‹¤ë¥¸ ìƒíƒœ: {} (ì‹­ì§„ìˆ˜: {})", result, decimal);
        return false;
    }
}

fn run_performance_test() {
    println("ğŸ¯ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (5íšŒ ì‹œë„)");
    println("========================");
    
    success_count = 0;
    total_trials = 5;
    
    trial_numbers = range(1, 6);
    for trial in trial_numbers {
        println("ì‹œë„ {}/{}:", trial, total_trials);
        
        grover_circuit = GroverComplete();
        result = measure(grover_circuit, [0, 1, 2, 3, 4]);
        
        if (analyze_result(result)) {
            success_count = success_count + 1;
        }
        
        println("");
    }
    
    success_rate = (success_count * 100) / total_trials;
    
    println("ğŸ† ìµœì¢… ê²°ê³¼:");
    println("============");
    println("ì„±ê³µ: {} / {} ì‹œë„", success_count, total_trials);
    println("ì„±ê³µë¥ : {}%", success_rate);
    
    if (success_rate >= 80) {
        println("ğŸ‰ í›Œë¥­í•œ ì„±ëŠ¥!");
    } else {
        if (success_rate >= 60) {
            println("âœ… ì–‘í˜¸í•œ ì„±ëŠ¥");
        } else {
            println("ğŸ”§ ì¶”ê°€ ìµœì í™” í•„ìš”");
        }
    }
}

fn main() {
    println("ğŸŒŸ ì™„ì „í•œ í•¨ìˆ˜ ê¸°ë°˜ Grover ì•Œê³ ë¦¬ì¦˜");
    println("=================================");
    println("ëª©í‘œ: |10101âŸ© ì°¾ê¸° (ì‹­ì§„ìˆ˜: 21)");
    println("");
    
    println("ğŸ¯ ê¸°ìˆ ì  í˜ì‹ :");
    println("==============");
    println("âœ… íšŒë¡œ ë‚´ë¶€ í•¨ìˆ˜ í˜¸ì¶œ");
    println("âœ… íšŒë¡œ ë‚´ë¶€ for ë°˜ë³µë¬¸");
    println("âœ… Oracleê³¼ Diffusion ë¶„ë¦¬");
    println("âœ… ì½”ë“œ ì¬ì‚¬ìš©ì„± ê·¹ëŒ€í™”");
    println("");
    
    run_performance_test();
    
    println("");
    println("ğŸš€ êµ¬ì¡°í™”ì˜ ì¥ì :");
    println("================");
    println("â€¢ Oracle í•¨ìˆ˜: ëª©í‘œ ìƒíƒœ ë³€ê²½ ì‹œ ìˆ˜ì • ìš©ì´");
    println("â€¢ Diffusion í•¨ìˆ˜: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸");
    println("â€¢ ë°˜ë³µë¬¸: ë°˜ë³µ íšŸìˆ˜ ë™ì  ì¡°ì • ê°€ëŠ¥");
    println("â€¢ í•¨ìˆ˜ ë¶„ë¦¬: ë””ë²„ê¹… ë° í…ŒìŠ¤íŠ¸ ìš©ì´");
}