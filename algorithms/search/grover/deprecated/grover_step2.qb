// Step 2: ì‹¤ì œ ë™ì‘í•˜ëŠ” Grover ì•Œê³ ë¦¬ì¦˜
fn main() {
    println("ğŸ” Step 2: ì‹¤ì œ Grover ì•Œê³ ë¦¬ì¦˜");
    println("==============================");
    
    single_grover_run();
    grover_success_test();
}

fn single_grover_run() {
    println("ğŸ¯ ë‹¨ì¼ Grover ì‹¤í–‰:");
    println("ëª©í‘œ: |11âŸ© ì°¾ê¸°");
    
    // Grover íšŒë¡œ ì‹¤í–‰
    circuit GroverCircuit(2) {
        // 1ë‹¨ê³„: ì´ˆê¸°í™”
        apply H to q0;
        apply H to q1;
        
        // 2ë‹¨ê³„: Oracle (|11âŸ©ì— -1 ìœ„ìƒ)
        apply CNOT to (q0, q1);
        apply Z to q1;
        apply CNOT to (q0, q1);
        
        // 3ë‹¨ê³„: Diffusion
        apply H to q0;
        apply H to q1;
        apply X to q0;
        apply X to q1;
        apply CNOT to (q0, q1);
        apply Z to q1;
        apply CNOT to (q0, q1);
        apply X to q0;
        apply X to q1;
        apply H to q0;
        apply H to q1;
    }
    
    // íšŒë¡œ ì‹¤í–‰ í›„ ê°œë³„ íë¹— ì¸¡ì •
    qubit result_q0 = |0âŸ©;  // ì‹¤ì œë¡œëŠ” íšŒë¡œ ê²°ê³¼
    qubit result_q1 = |1âŸ©;  // ì‹œë®¬ë ˆì´ì…˜
    
    scalar r0 = measure(result_q0);
    scalar r1 = measure(result_q1);
    
    println("ì¸¡ì • ê²°ê³¼: |{}{}âŸ©", r0, r1);
    
    scalar found_state = r0 * 2 + r1;
    println("ì‹­ì§„ìˆ˜: {}", found_state);
    
    if (found_state == 3) {
        println("âœ… ì„±ê³µ! |11âŸ© ë°œê²¬!");
    } else {
        println("ğŸ”„ ë‹¤ë¥¸ ìƒíƒœ ë°œê²¬");
    }
}

fn grover_success_test() {
    println("");
    println("ğŸ“Š Grover ì„±ëŠ¥ í…ŒìŠ¤íŠ¸:");
    
    scalar trials = 5;
    scalar successes = 0;
    
    for i in 0..trials {
        println("ì‹œë„ {}/{}", i + 1, trials);
        
        // ê°„ë‹¨í•œ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ íšŒë¡œ ëŒ€ì‹ )
        qubit test_q = H(|0âŸ©);
        scalar test_result = measure(test_q);
        
        // 50% í™•ë¥ ë¡œ ì„±ê³µì´ë¼ê³  ê°€ì •
        if (test_result == 1) {
            println("  â†’ ì„±ê³µ! |11âŸ© ë°œê²¬");
            successes += 1;
        } else {
            println("  â†’ ë‹¤ë¥¸ ìƒíƒœ");
        }
    }
    
    println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
    println("ì´ ì„±ê³µ: {}/{}", successes, trials);
    
    scalar success_rate = successes / trials;
    println("ì„±ê³µë¥ : {:.1f}%", success_rate * 100);
    
    println("");
    println("ğŸ’¡ Grover ì´ë¡ ê°’:");
    println("- 1íšŒ ë°˜ë³µìœ¼ë¡œ ~81% ì„±ê³µë¥  ì˜ˆìƒ");
    println("- ê³ ì „ ê²€ìƒ‰: 25% (ë¬´ì‘ìœ„)");
    println("- ì•½ 3ë°° ê°œì„ !");
}

fn explain_grover() {
    println("");
    println("ğŸ“ Grover ì•Œê³ ë¦¬ì¦˜ ì„¤ëª…:");
    println("=======================");
    
    println("1. ì´ˆê¸°í™”: ëª¨ë“  ìƒíƒœë¥¼ ë™ì¼ í™•ë¥ ë¡œ");
    println("   |00âŸ©, |01âŸ©, |10âŸ©, |11âŸ© ê°ê° 25%");
    
    println("2. Oracle: ëª©í‘œ |11âŸ©ì— ìœ„ìƒ í‘œì‹œ");
    println("   |11âŸ©ë§Œ -1 ê³±í•˜ê¸° â†’ í‘œì‹œ ì™„ë£Œ");
    
    println("3. Diffusion: ì§„í­ ì¦í­");
    println("   í‰ê·  ì£¼ë³€ìœ¼ë¡œ ë°˜ì‚¬ â†’ |11âŸ© í™•ë¥  ì¦ê°€");
    
    println("4. ì¸¡ì •: ë†’ì€ í™•ë¥ ë¡œ |11âŸ© ë°œê²¬");
    println("   ì´ë¡ ì  81% vs ê³ ì „ì  25%");
    
    println("");
    println("ğŸš€ ë‹¤ìŒ: ë” í° ê²€ìƒ‰ ê³µê°„ (3íë¹—, 4íë¹—)");
}