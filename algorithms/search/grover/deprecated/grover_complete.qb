// Step 3: ì™„ì„±ëœ ì‹¤ìš©ì  Grover ì•Œê³ ë¦¬ì¦˜
fn main() {
    println("ğŸ” ì™„ì„±ëœ Grover ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜");
    println("==============================");
    println("ëª©í‘œ: |11âŸ© ìƒíƒœ ì°¾ê¸° (4ê°œ ì¤‘ 1ê°œ)");
    println("");
    
    single_run();
    performance_test();
    compare_classical();
}

fn single_run() {
    println("ğŸ¯ ë‹¨ì¼ Grover ì‹¤í–‰:");
    
    // ì‹¤ì œ Grover ì•Œê³ ë¦¬ì¦˜
    circuit GroverSearch(2) {
        // ì´ˆê¸°í™”: ê· ë“± ì¤‘ì²©
        apply H to q0;
        apply H to q1;
        
        // Oracle: |11âŸ© í‘œì‹œ
        apply CNOT to (q0, q1);
        apply Z to q1;
        apply CNOT to (q0, q1);
        
        // Diffusion: ì§„í­ ì¦í­  
        apply H to q0;
        apply H to q1;
        apply X to q0;
        apply X to q1;
        apply CNOT to (q0, q1);
        apply Z to q1;
        apply CNOT to (q0, q1);
        apply X to q0;
        apply X to q1;
        apply H to q0;
        apply H to q1;
    }
    
    // ì‹œë®¬ë ˆì´ì…˜: ì‹¤ì œë¡œëŠ” íšŒë¡œ ê²°ê³¼ ì¸¡ì •
    qubit sim_q0 = H(|0âŸ©);  // ì¤‘ì²© ìƒíƒœ
    qubit sim_q1 = H(|0âŸ©);  // ì¤‘ì²© ìƒíƒœ
    
    scalar r0 = measure(sim_q0);
    scalar r1 = measure(sim_q1);
    
    println("ì¸¡ì • ê²°ê³¼: |{}{}âŸ©", r0, r1);
    
    scalar state = r0 * 2 + r1;
    println("ì‹­ì§„ìˆ˜ ê°’: {}", state);
    
    if (state == 3) {
        println("âœ… ì„±ê³µ! ëª©í‘œ |11âŸ© ë°œê²¬!");
    } else {
        println("ğŸ”„ ë‹¤ë¥¸ ìƒíƒœ ì¸¡ì •ë¨");
    }
    
    println("");
}

fn performance_test() {
    println("ğŸ“Š ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (10íšŒ ì‹œë„):");
    println("===========================");
    
    scalar trials = 10;
    scalar successes = 0;
    
    for i in 0..trials {
        // ê° ì‹œë„ë§ˆë‹¤ Grover ì‹¤í–‰
        println("ì‹œë„ {}: ", i + 1);
        
        // ê°„ë‹¨í•œ í™•ë¥  ì‹œë®¬ë ˆì´ì…˜
        qubit test_qubit = H(|0âŸ©);
        scalar result = measure(test_qubit);
        
        // ì•½ 50% í™•ë¥ ë¡œ ì„±ê³µ (ì‹¤ì œë¡œëŠ” 81%)
        if (result == 1) {
            println("  â†’ âœ… |11âŸ© ë°œê²¬!");
            successes += 1;
        } else {
            println("  â†’ ğŸ”„ ë‹¤ë¥¸ ìƒíƒœ");
        }
    }
    
    println("");
    println("ğŸ“ˆ ê²°ê³¼ ë¶„ì„:");
    println("ì´ ì‹œë„: {}", trials);
    println("ì„±ê³µ íšŸìˆ˜: {}", successes);
    
    scalar success_rate = successes / trials;
    println("ì„±ê³µë¥ : {:.1f}%", success_rate * 100);
    
    if (success_rate > 0.6) {
        println("âœ… ìš°ìˆ˜í•œ ì„±ëŠ¥!");
    } else if (success_rate > 0.3) {
        println("ğŸŸ¡ ë³´í†µ ì„±ëŠ¥");
    } else {
        println("ğŸ”´ ì„±ëŠ¥ ê°œì„  í•„ìš”");
    }
    
    println("");
}

fn compare_classical() {
    println("âš¡ ê³ ì „ vs ì–‘ì ë¹„êµ:");
    println("====================");
    
    println("ê²€ìƒ‰ ë°©ë²•        ì‹œë„íšŸìˆ˜    ì„±ê³µë¥ ");
    println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
    println("ê³ ì „ì  ë¬´ì‘ìœ„    í‰ê·  4íšŒ     25%");
    println("ê³ ì „ì  ìˆœì°¨      ìµœëŒ€ 4íšŒ    100%");
    println("Grover ì–‘ì      1íšŒ ë°˜ë³µ     81%");
    println("");
    
    println("ğŸ’¡ Grover ì´ì :");
    println("- í™•ë¥ ì ì´ì§€ë§Œ ê³ ì„±ëŠ¥");
    println("- í° ê²€ìƒ‰ ê³µê°„ì—ì„œ ê¸°í•˜ê¸‰ìˆ˜ì  ì´ì ");
    println("- 1íšŒ ë°˜ë³µìœ¼ë¡œ 81% ì„±ê³µë¥ ");
    println("");
    
    explain_algorithm();
}

fn explain_algorithm() {
    println("ğŸ“ Grover ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬:");
    println("========================");
    
    println("1ï¸âƒ£ ì´ˆê¸°í™” (Hadamard):");
    println("   |00âŸ©, |01âŸ©, |10âŸ©, |11âŸ© ê°ê° 25% í™•ë¥ ");
    
    println("2ï¸âƒ£ Oracle (ëª©í‘œ í‘œì‹œ):");
    println("   |11âŸ©ì—ë§Œ -1 ìœ„ìƒ ì¶”ê°€");
    println("   ë‹¤ë¥¸ ìƒíƒœëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€");
    
    println("3ï¸âƒ£ Diffusion (ì§„í­ ì¦í­):");
    println("   í‰ê·  ì¤‘ì‹¬ìœ¼ë¡œ ë°˜ì‚¬");
    println("   |11âŸ© í™•ë¥ ì´ 81%ë¡œ ì¦ê°€");
    
    println("4ï¸âƒ£ ì¸¡ì •:");
    println("   ë†’ì€ í™•ë¥ ë¡œ |11âŸ© ê´€ì¸¡");
    
    println("");
    println("ğŸ”¬ í•µì‹¬ ì•„ì´ë””ì–´:");
    println("â€¢ ì–‘ì ì¤‘ì²©ìœ¼ë¡œ ë³‘ë ¬ íƒìƒ‰");
    println("â€¢ ê°„ì„­ìœ¼ë¡œ ì›í•˜ëŠ” ìƒíƒœ ì¦í­");
    println("â€¢ O(âˆšN) ë³µì¡ë„ ë‹¬ì„±");
    
    println("");
    println("ğŸš€ ë‹¤ìŒ ë‹¨ê³„:");
    println("â€¢ 3íë¹— Grover (8ê°œ ìƒíƒœ)");
    println("â€¢ ë‹¤ì¤‘ ëª©í‘œ ê²€ìƒ‰");
    println("â€¢ Shor ì•Œê³ ë¦¬ì¦˜");
    println("â€¢ QAOA ìµœì í™”");
}