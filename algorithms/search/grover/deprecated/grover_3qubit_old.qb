// 3íë¹— Grover ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜
// ëª©í‘œ: 8ê°œ ìƒíƒœ ì¤‘ |101âŸ© (ì‹­ì§„ìˆ˜ 5) ì°¾ê¸°

fn main() {
    println("ğŸ” 3íë¹— Grover ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜");
    println("=============================");
    println("ëª©í‘œ: |101âŸ© ìƒíƒœ ì°¾ê¸° (8ê°œ ì¤‘ 1ê°œ)");
    println("ì´ë¡ ì  ì„±ê³µë¥ : ~85%");
    println("");
    
    single_run();
    performance_test();
    algorithm_analysis();
}

fn single_run() {
    println("ğŸ¯ ë‹¨ì¼ 3íë¹— Grover ì‹¤í–‰:");
    
    circuit Grover3Qubit(3) {
        // 1. ì´ˆê¸°í™”: ëª¨ë“  íë¹—ì„ ì¤‘ì²©ìƒíƒœë¡œ
        apply H to q0;
        apply H to q1;
        apply H to q2;
        
        // 2. ì²« ë²ˆì§¸ Grover ë°˜ë³µ
        // Oracle: |101âŸ© ìƒíƒœë§Œ ìœ„ìƒ ë’¤ì§‘ê¸°
        apply X to q1;        // |101âŸ© â†’ |111âŸ© ë³€í™˜
        apply Z to q0;        // q0ê°€ |1âŸ©ì¼ ë•Œë§Œ
        apply Z to q1;        // q1ì´ |1âŸ©ì¼ ë•Œë§Œ  
        apply Z to q2;        // q2ê°€ |1âŸ©ì¼ ë•Œë§Œ
        apply CNOT to (q0, q1);  // ì¡°ê±´ë¶€ ì—°ì‚°
        apply CNOT to (q1, q2);  // ì¡°ê±´ë¶€ ì—°ì‚°
        apply Z to q2;        // ìµœì¢… ìœ„ìƒ ë’¤ì§‘ê¸°
        apply CNOT to (q1, q2);  // ë³µì›
        apply CNOT to (q0, q1);  // ë³µì›
        apply X to q1;        // |111âŸ© â†’ |101âŸ© ë³µì›
        
        // Diffusion ì—°ì‚°ì
        apply H to q0;
        apply H to q1;
        apply H to q2;
        apply X to q0;
        apply X to q1;
        apply X to q2;
        apply CNOT to (q0, q2);
        apply CNOT to (q1, q2);
        apply Z to q2;
        apply CNOT to (q1, q2);
        apply CNOT to (q0, q2);
        apply X to q0;
        apply X to q1;
        apply X to q2;
        apply H to q0;
        apply H to q1;
        apply H to q2;
        
        // 3. ë‘ ë²ˆì§¸ Grover ë°˜ë³µ
        // Oracle ë‹¤ì‹œ
        apply X to q1;
        apply CNOT to (q0, q2);
        apply CNOT to (q1, q2);
        apply Z to q2;
        apply CNOT to (q1, q2);
        apply CNOT to (q0, q2);
        apply X to q1;
        
        // Diffusion ë‹¤ì‹œ
        apply H to q0;
        apply H to q1;
        apply H to q2;
        apply X to q0;
        apply X to q1;
        apply X to q2;
        apply CNOT to (q0, q2);
        apply CNOT to (q1, q2);
        apply Z to q2;
        apply CNOT to (q1, q2);
        apply CNOT to (q0, q2);
        apply X to q0;
        apply X to q1;
        apply X to q2;
        apply H to q0;
        apply H to q1;
        apply H to q2;
    }
    
    grover_circuit = Grover3Qubit(3);
    results = measure(grover_circuit, [0, 1, 2]);
    
    scalar r0 = results[0];
    scalar r1 = results[1];
    scalar r2 = results[2];
    
    println("ì¸¡ì • ê²°ê³¼: |{}{}{}âŸ©", r2, r1, r0);
    
    scalar state = r0 + r1 * 2 + r2 * 4;
    println("ì‹­ì§„ìˆ˜ ê°’: {}", state);
    
    if (state == 5) {
        println("âœ… ì„±ê³µ! ëª©í‘œ |101âŸ© ë°œê²¬!");
    } else {
        println("ğŸ”„ ë‹¤ë¥¸ ìƒíƒœ ì¸¡ì •ë¨");
    }
    
    println("");
}

fn performance_test() {
    println("ğŸ“Š 3íë¹— ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (15íšŒ ì‹œë„):");
    println("================================");
    
    scalar trials = 15;
    scalar successes = 0;
    
    for i in 0..trials {
        println("ì‹œë„ {}: ", i + 1);
        
        // ì‹¤ì œ 3íë¹— Grover íšŒë¡œ ì‹¤í–‰
        test_circuit = Grover3Qubit(3);
        test_results = measure(test_circuit, [0, 1, 2]);

        scalar r0 = test_results[0];
        scalar r1 = test_results[1];
        scalar r2 = test_results[2];
        
        scalar result = r0 + r1 * 2 + r2 * 4;
        
        println("  â†’ |{}{}{}âŸ© (ê°’: {})", r2, r1, r0, result);
        
        if (result == 5) {
            println("     âœ… ì„±ê³µ!");
            successes = successes + 1;
        } else {
            println("     ğŸ”„ ê³„ì†");
        }
    }
    
    println("");
    println("ğŸ“ˆ 3íë¹— ê²°ê³¼ ë¶„ì„:");
    println("ì´ ì‹œë„: {}", trials);
    println("ì„±ê³µ íšŸìˆ˜: {}", successes);
    
    scalar success_rate = successes / trials;
    println("ì„±ê³µë¥ : {:.1f}%", success_rate * 100);
    
    if (success_rate > 0.8) {
        println("âœ… ìš°ìˆ˜í•œ ì„±ëŠ¥! (ì´ë¡ ê°’ 85%ì— ê·¼ì ‘)");
    } else {
        if (success_rate > 0.6) {
            println("ğŸŸ¡ ë³´í†µ ì„±ëŠ¥ (ì–‘ì í™•ë¥ ì  íŠ¹ì„±)");
        } else {
            println("ğŸ”„ ì¬ì¡°ì • í•„ìš”");
        }
    }
    
    println("");
}

fn algorithm_analysis() {
    println("ğŸ“ 3íë¹— Grover ë¶„ì„:");
    println("====================");
    
    println("ğŸ”¢ ìƒíƒœ ê³µê°„:");
    println("â€¢ ì´ 8ê°œ ìƒíƒœ: |000âŸ© ~ |111âŸ©");
    println("â€¢ ëª©í‘œ: |101âŸ© (ì‹­ì§„ìˆ˜ 5)");
    println("â€¢ ê²€ìƒ‰ ê³µê°„: 2Â³ = 8");
    
    println("");
    println("âš¡ ì•Œê³ ë¦¬ì¦˜ ë‹¨ê³„:");
    println("1ï¸âƒ£ ì´ˆê¸°í™”: H âŠ— H âŠ— H");
    println("2ï¸âƒ£ Oracle: |101âŸ© ìœ„ìƒ ë’¤ì§‘ê¸°");
    println("3ï¸âƒ£ Diffusion: í‰ê·  ì¤‘ì‹¬ ë°˜ì‚¬");
    println("4ï¸âƒ£ ë°˜ë³µ: 2íšŒ (ìµœì ê°’)");
    
    println("");
    println("ğŸ“Š ì„±ëŠ¥ ë¹„êµ:");
    println("=============");
    println("ë°©ë²•           ë³µì¡ë„    ì„±ê³µë¥ ");
    println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
    println("ê³ ì „ ë¬´ì‘ìœ„    O(8)      12.5%");
    println("ê³ ì „ ìˆœì°¨      O(8)      100%");
    println("3íë¹— Grover   O(âˆš8)     ~85%");
    
    println("");
    println("ğŸš€ í™•ì¥ ê°€ëŠ¥ì„±:");
    println("â€¢ 4íë¹—: 16ê°œ ìƒíƒœ ê²€ìƒ‰");
    println("â€¢ Níë¹—: 2á´ºê°œ ìƒíƒœ ê²€ìƒ‰");
    println("â€¢ ë³µí•© Oracle ì„¤ê³„");
    println("â€¢ ë‹¤ì¤‘ íƒ€ê²Ÿ ê²€ìƒ‰");
}