// ê°œë³„ íšŒë¡œë¡œ ë¶„ë¦¬ëœ Deutsch-Jozsa ì•Œê³ ë¦¬ì¦˜

fn oracle_constant_0() {
    println("    Oracle: f(x) = 0 (ìƒìˆ˜í•¨ìˆ˜)");
    // ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
}

fn oracle_constant_1() {
    println("    Oracle: f(x) = 1 (ìƒìˆ˜í•¨ìˆ˜)");
    apply X to q1;
}

fn oracle_balanced_identity() {
    println("    Oracle: f(x) = x (ê· í˜•í•¨ìˆ˜)");
    apply CNOT to (q0, q1);
}

fn oracle_balanced_not() {
    println("    Oracle: f(x) = NOT x (ê· í˜•í•¨ìˆ˜)");
    apply X to q0;
    apply CNOT to (q0, q1);
    apply X to q0;
}

fn analyze_result(result, expected_type, test_name) {
    println("  ì¸¡ì • ê²°ê³¼: {}", result);
    
    if (result[0] == 0) {
        println("  ğŸ“Š íŒë³„: ìƒìˆ˜í•¨ìˆ˜");
        if (expected_type == 0) {
            println("  âœ… {} ì„±ê³µ!", test_name);
            return true;
        } else {
            println("  âŒ {} ì‹¤íŒ¨", test_name);
            return false;
        }
    } else {
        println("  ğŸ“Š íŒë³„: ê· í˜•í•¨ìˆ˜");
        if (expected_type == 1) {
            println("  âœ… {} ì„±ê³µ!", test_name);
            return true;
        } else {
            println("  âŒ {} ì‹¤íŒ¨", test_name);
            return false;
        }
    }
}

fn test_constant_0() {
    println("í…ŒìŠ¤íŠ¸ 1: f(x) = 0");
    
    circuit DeutschConstant0(2) {
        apply X to q1;
        apply H to ~;
        oracle_constant_0();
        apply H to q0;
    }
    
    circuit = DeutschConstant0(2);
    result = measure(circuit, [0]);
    
    return analyze_result(result, 0, "ìƒìˆ˜í•¨ìˆ˜ f(x)=0");
}

fn test_constant_1() {
    println("í…ŒìŠ¤íŠ¸ 2: f(x) = 1");
    
    circuit DeutschConstant1(2) {
        apply X to q1;
        apply H to ~;
        oracle_constant_1();
        apply H to q0;
    }
    
    circuit = DeutschConstant1(2);
    result = measure(circuit, [0]);
    
    return analyze_result(result, 0, "ìƒìˆ˜í•¨ìˆ˜ f(x)=1");
}

fn test_balanced_identity() {
    println("í…ŒìŠ¤íŠ¸ 3: f(x) = x");
    
    circuit DeutschBalancedId(2) {
        apply X to q1;
        apply H to ~;
        oracle_balanced_identity();
        apply H to q0;
    }
    
    circuit = DeutschBalancedId(2);
    result = measure(circuit, [0]);
    
    return analyze_result(result, 1, "ê· í˜•í•¨ìˆ˜ f(x)=x");
}

fn test_balanced_not() {
    println("í…ŒìŠ¤íŠ¸ 4: f(x) = NOT x");
    
    circuit DeutschBalancedNot(2) {
        apply X to q1;
        apply H to ~;
        oracle_balanced_not();
        apply H to q0;
    }
    
    circuit = DeutschBalancedNot(2);
    result = measure(circuit, [0]);
    
    return analyze_result(result, 1, "ê· í˜•í•¨ìˆ˜ f(x)=NOT x");
}

fn run_all_tests() {
    println("ğŸ§ª Deutsch-Jozsa ì „ì²´ í…ŒìŠ¤íŠ¸");
    println("============================");
    
    success_count = 0;
    
    if (test_constant_0()) {
        success_count = success_count + 1;
    }
    println("");
    
    if (test_constant_1()) {
        success_count = success_count + 1;
    }
    println("");
    
    if (test_balanced_identity()) {
        success_count = success_count + 1;
    }
    println("");
    
    if (test_balanced_not()) {
        success_count = success_count + 1;
    }
    println("");
    
    success_rate = (success_count * 100) / 4;
    
    println("ğŸ† ìµœì¢… ê²°ê³¼:");
    println("============");
    println("ì„±ê³µ: {} / 4 í…ŒìŠ¤íŠ¸", success_count);
    println("ì„±ê³µë¥ : {}%", success_rate);
    
    return success_rate;
}

fn main() {
    println("ğŸŒŸ Deutsch-Jozsa ì•Œê³ ë¦¬ì¦˜");
    println("========================");
    println("ëª©ì : í•¨ìˆ˜ê°€ ìƒìˆ˜ì¸ì§€ ê· í˜•ì¸ì§€ 1ë²ˆ í˜¸ì¶œë¡œ íŒë³„");
    println("");
    
    success_rate = run_all_tests();
    
    println("");
    println("ğŸš€ ì„±ëŠ¥ ë¶„ì„:");
    println("=============");
    println("ê³ ì „ ì•Œê³ ë¦¬ì¦˜: ìµœì•… 3ë²ˆ í•¨ìˆ˜ í˜¸ì¶œ");
    println("ì–‘ì ì•Œê³ ë¦¬ì¦˜: 1ë²ˆ í•¨ìˆ˜ í˜¸ì¶œ");
    
    if (success_rate == 100) {
        println("ğŸ‰ ì™„ë²½í•œ Deutsch-Jozsa êµ¬í˜„!");
    } else {
        println("ğŸ”§ ì¶”ê°€ ë””ë²„ê¹… í•„ìš” ({}% ì„±ê³µ)", success_rate);
    }
}